# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1sG261uDkEwoGdZmdKwHxmxqeeVN5cGxZ
"""

import pandas as pd
import streamlit as st
import implicit
from scipy.sparse import csr_matrix
from sklearn.model_selection import train_test_split
import gdown

# 1. Cargar los datos desde Google Drive
@st.cache_data
def cargar_datos():
    url = 'https://drive.google.com/uc?id=1NmAZBoSj8YqWFbypAm8HYMj2YHbRyggT'  # Enlace proporcionado
    output = 'datos.csv'
    gdown.download(url, output, quiet=False)  # Descargar el archivo
    return pd.read_csv(output)

# 2. Filtrar productos por categoría seleccionada
def filtrar_por_categoria(df, categoria_seleccionada):
    df_filtrado = df[df['SECCION'] == categoria_seleccionada]
    if df_filtrado.empty:
        st.warning(f"No se encontraron productos para la categoría seleccionada: {categoria_seleccionada}")
    return df_filtrado

# Configurar Streamlit

st.title("Sistema de Recomendación de Productos")

# Cargar los datos
df = cargar_datos()

# **Vista previa de los datos cargados**
st.write("Vista previa de los datos cargados:")
st.write(df.head())  # Mostrar las primeras filas del dataframe

# Verificar las columnas del DataFrame
st.write("Columnas del DataFrame:")
st.write(df.columns)

# Selección de la categoría
categoria_seleccionada = st.sidebar.radio(
    "Seleccione una Categoría",
    ('Limpieza del Hogar', 'Cuidado Personal', 'Bebidas', 'Alimentos')
)

# Filtrar por categoría
df_categoria = filtrar_por_categoria(df, categoria_seleccionada)

# Si no se encuentran productos para la categoría seleccionada, mostramos una advertencia
if df_categoria.empty:
    st.warning(f"No se encontraron productos para la categoría seleccionada: {categoria_seleccionada}")
else:
    # Mostrar vista previa de los productos en la categoría seleccionada
    st.write(f"Vista previa de productos en la categoría '{categoria_seleccionada}':")
    st.write(df_categoria.head())
